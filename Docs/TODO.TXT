Chores
======

[ ] Add logging
    [ ] ProcessUtils and DotNetUtils?
[ ] Unit tests
    [ ] Exception handling in all scenarios

Bugs
====

[ ] Exception thrown in FileUtils.CreateDirectory() when user types in goofy output path
[ ] Time Remaining is jumpy, esp. > 80% complete.  Thread queue?

Features
========

[ ] Add track filter

[ ] Display drives above input textbox (like VidCoder)
[ ] Background thread for drive detection
[ ] Centralize drive detection logic
[ ] Handle exceptions during drive detection

[ ] Split output MKV path into directory and file name
    [ ] Move output file name settings out into Preferences dialog (similar to mmg)
    [ ] Separate file namer preferences for movies and TV shows
[ ] File Namer placeholders
    [ ] Add fields to Job class for DirectoryPathTemplate and FileNameTemplate, which File Namer will combine and expand into OutputMkvPath

[ ] Angle support
[ ] Fix or remove "low quality" playlist detection
[ ] Consider chapter count and timestamps when looking for duplicate playlists (playlists w/ identical streams but different chapters are not dups)

[ ] CLI prompt to select TMDb search result, playlist, angle, overwrite existing file
[ ] Plugin hooks for UI events:
    [ ] Select a movie/TV show
    [ ] Re-configure playlist (change Cut, Language, selected tracks) -- (for updating output file name, MKV title, track title)
[ ] Allow any BD-ROM file/subdirectory to be scanned

Backlog
=======

[ ] Allow pausing of tasks

[ ] CLI arg to dump list of main movie playlist files
[ ] Asynchronous TMDb poster/cover art getter thread (use futures?)

[ ] Add Windows 7 Taskbar buttons for pause/resume and cancel
[ ] Add Windows 7 Taskbar jump lists?

Chris' Plugins
==============

[ ] TMDb: Parse year out of Job.SearchQuery
[ ] TMDb: Report more detailed, fine-grained progress when loading lots of search results and poster images
[ ] Chapter Grabber: (THE MATRIX REVOLUTIONS):
    01:57:31.210: Freedom and Sunlight
    02:00:12.371: End Credits
    02:09:13.745: 
[ ] URI encoding (e.g., http://chapterdb.org/chapters/search?title=BLACK HAWK DOWN&chapterCount=0)
[ ] Unescape XML/HTML entities (e.g., "&amp;" -> "&")
[ ] Search ALL media types in Chapter Grabber plugin (not just Blu-ray)
[ ] Use chapter grabber plugin to auto-detect main movie by comparing playlists to ChapterDb search results

Complete
========

[X] Add "Rescan" menu item (F5)
[N] Add "Convert" menu item
[X] Add "Show log file in Windows Explorer"
[X] Add separate class for project URLs and to launch them
[X] Show BDHero version number in FormMain title
[X] Detect drives on startup
[X] Menu bar
[X] Basic about box
[X] Update output MKV path when user's selection changes
[X] Chapter Grabber: (IN_TIME)
    Scene 1
    Scene 2
    Scene 3
[X] Switch to "Save File" dialog for output MKV path
[X] MIRROR_MIRROR_BD doesn't auto-detect any Main Feature playlists
[X] GUI repaints but does not respond to user input while scanning disc.  Thread queue?
[X] Don't load AppData plugins when *.vhost.exe is present in PluginService.cs
[X] Drag-n-drop scanning
[X] Scan automatically after Browse
[X] NPE when scanning CASINO_ROYAL:
    2013-07-01 00:59:14,967 [1176][1] ERROR BDHero.Controller - Unhandled exception was thrown by plugin
    System.NullReferenceException: Object reference not set to an instance of an object.
       at BDHero.Plugin.DiscReader.Transformer.StreamClipTransformer.Transform(TSStreamClip tsStreamClip, Int32 index)
       at System.Linq.Enumerable.<SelectIterator>d__7`2.MoveNext()
       at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
       at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
       at BDHero.Plugin.DiscReader.Transformer.StreamClipTransformer.Transform(IEnumerable`1 tsStreamClips)
       at BDHero.Plugin.DiscReader.Transformer.PlaylistTransformer.Transform(TSPlaylistFile playlistFile)
       at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
       at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
       at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
       at BDHero.Plugin.DiscReader.Transformer.PlaylistTransformer.Transform(IEnumerable`1 playlistFiles)
       at BDHero.Plugin.DiscReader.Transformer.DiscTransformer.Transform(BDROM bdrom)
       at BDHero.Plugin.DiscReader.DiscReader.ReadBDROM(CancellationToken cancellationToken, String bdromPath)
       at BDHero.Controller.<>c__DisplayClass25.<ReadBDROM>b__24(CancellationToken token)
       at BDHero.Controller.<>c__DisplayClass22.<RunPluginSync>b__20(IThreadInvoker invoker, CancellationToken token)
       at DotNetUtils.TaskUtils.TaskBuilder.<InvokeDoWork>b__2()
       at DotNetUtils.TaskUtils.TaskBuilder.Try(Action action)
[X] Don't skip unknown codecs - ffmpeg includes ALL codecs when counting streams (even IGS and DTS Express), which means BDHero's track indexes won't match
[X] Estimated time left -- double decrement bug
[X] Exception not propagated to UI and doesn't stop UI:
    2013-06-27 16:57:24,043 [6620][7] ERROR ProcessUtils.NonInteractiveProcess - Error occurred while starting/running NonInteractiveProcess
    System.InvalidOperationException: Requested process already belongs to another job group. Check http://stackoverflow.com/a/4232259/3205 for help.
       at ProcessUtils.JobObject2.AssignProcess(IntPtr handle)
       at ProcessUtils.JobObject2.AssignProcess(Process process)
       at ProcessUtils.NonInteractiveProcess.StartImpl()
       at ProcessUtils.NonInteractiveProcess.Start()
    2013-06-27 16:57:24,063 [6620][7] ERROR ProcessUtils.BackgroundProcessWorker - Error occurred while running NonInteractiveProcess in BackgroundWorker
    System.InvalidOperationException: No process is associated with this object.
       at System.Diagnostics.Process.EnsureState(State state)
       at System.Diagnostics.Process.get_HasExited()
       at ProcessUtils.NonInteractiveProcess.get_CanKill()
       at ProcessUtils.NonInteractiveProcess.Kill()
       at ProcessUtils.NonInteractiveProcess.Start()
[X] Create parent dirs of output file
[X] What if mkvpropedit.exe, ffmpeg.exe, etc. don't exist?  Currently the UI just hangs
    [X] Exceptions thrown in NonInteractiveProcess.Start() are not caught - they just disappear and the UI hangs
[X] Exception when pressing cancel during FFmpeg after EXE has exited immediately due to an error:
System.AggregateException: One or more errors occurred. ---> System.InvalidOperationException: No process is associated with this object.
   at System.Diagnostics.Process.get_HasExited()
   at ProcessUtils.NonInteractiveProcess.get_CanKill()
[X] Parse FFmpeg error output when output path is not writeable (dir doesn't exist)
[X] mkvpropedit.exe
[X] Filter bad chars in output file names
[X] Fix race condition in cancelation/status reporting
[X] Allow cancellation of tasks
[X] Dependency Injection
[X] Threaded controller
    http://reedcopsey.com/2009/11/17/synchronizing-net-4-tasks-with-the-ui-thread/
[X] Break Controller.cs into separate classes: AppConfig (initialize directories; singleton), LogInitializer (singleton), PluginLoader
[X] Reorganize solution using VS "Solution Folders"
[X] Basic CLI args
[X] Remove PluginException
[X] Auto file namer
[X] Error detection, handling, and status for FFmpeg (stderr + exit code)
[X] Job objects not working
[X] Movie title (year) in MKV title field
[X] Use larger poster image

[N] Don't set PGS subs to default
[!] Auto-default tracks in FFmpeg/MkvPropEdit (doesn't appear to be possible: FFmpeg doesn't include the flags in its output, so adding them with mkvpropedit breaks the MKV file)
